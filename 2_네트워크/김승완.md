# IP

## 출발지IP 에서 목적지IP로 데이터를 전송하는 방법은?

이는 우체국으로 편지를 보내는 과정과 같다.

즉, 출발지 -> 출발지 동네의 우체국 -> 목적지 동네의 우체국 -> 목적지 와 같은데, 이 때 우체국은 게이트웨이를 뜻한다.

바꿔 말하면 출발지IP -> 출발지 LAN 영역의 게이트웨이 -> 목적지 LAN 영역의 게이트웨이 -> 목적지IP 의 과정과 같다.

예를 들어, 출발지IP 주소를 192.168.0.4 라고 하고, 목적지IP 주소를 10.10.10.10 라고 가정하겠다.

먼저, 두 IP주소의 네트워크ID를 비교한다. 이 때, 서브넷 마스크를 활용해서 네트워크ID와 호스트ID를 알아낸다.

여기서 만약 두 IP주소의 네트워크ID가 같으면 스위칭을, 다르면 라우팅을 진행합니다.

라우팅은 게이트웨이를 통해 통신(데이터 전송)해야한다.

이 때, 스위칭을 하는 경우에는 호스트ID와 MAC주소를 통해 전달하면 된다.

반면, 라우팅을 해야하는 경우에는 우선 OS에서 목적지IP를 게이트웨이 IP주소로 변경한다. 이 때, 스위칭이 필요하다.

1. 해당 게이트웨이의 MAC주소를 알기 위해 ARP 캐시 테이블로 가서 해당 게이트웨이의 MAC 주소가 등록되어있는지 체크한다.

\*\*\* 예를 들어, 우리 동네의 우체국이 어딘지는 알지만, 다른 동네의 우체국 위치까지는 모른다. 이처럼, 같은 LAN영역 내의 게이트웨이 IP주소는 사전에 알고 있기 때문에 바로 OS에서 목적지IP를 변경할 수 있다.

2. 만약 ARP 캐시 테이블에 게이트웨이의 MAC 주소가 등록되어있지 않으면 브로드캐스트 방식으로 LAN 영역 내의 ARP를 요청한다.

여기서 브로드캐스트 방식이란, 자신과 같은 네트워크ID(LAN 영역 내) 를 사용하는 모든 호스트에게 데이터를 전송하는 방식이다.

3. 이렇게 브로드캐스트로 모두에게 쏘면, 나다 싶은 호스트(게이트웨이) 가 이를 듣고 유니캐스트 방식으로 발신자에게 ARP를 전송한다. 이 때의 ARP는 게이트웨이의 MAC주소이다.

여기서 유니캐스트 방식은 브로드캐스트 방식과 반대로 특정 호스트에게 데이터를 전송하는 방식이다.

4. 이후에는 OS가 전송하고자 하는 데이터를 유니캐스트 방식으로 목적지IP가 포함된 동네(LAN 영역)의 게이트웨이에 전송한다.

5. 목적지 동네의 게이트웨이가 스위칭을 사용하여 목적지IP 주소로 데이터를 전송한다.

\*\*\* ARP 영역 : 2) 의 과정이 진행되는 영역.

이렇듯 IP 주소간에 데이터를 전송하기 위해서는 ARP와 라우팅이 반드시 필요하며, 이 둘을 꼭 사용해야 한다.

## 데이터가 만약 클 경우?

데이터가 클 경우 데이터는 패킷(Packet)이라는 단위로 나눠져서 전달이 되는데 이렇게 패킷단위로 메세지를 전달하는것도 Ip가 하는 일이다. 그 이유는 우리의 데이터 단위가 크다면 각 노드들은 여러 컴퓨터에서온 데이터를 처리하다가 병목현상이 발생할 수 있기 때문에 작은 크기로 나눠서 빠르게 다음 노드로 전달하기 위해서이다

## 이로 미루어본 IP의 역할

1. 출발지 ip주소에서 부터 목적지 ip주소 까지 데이터전달

2. 데이터를 패킷이라는 단위로 나눠서 데이터를 전달
